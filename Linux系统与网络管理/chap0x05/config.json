{
  "redirect_rule":[{
      "to_uri":"/verynginx/index.html",
      "matcher":"demo_other_verynginx_uri",
      "enable":true
    }],
  "filter_rule":[{
      "enable":false,
      "action":"accept",
      "matcher":"localhost"
    },{
      "enable":true,
      "action":"block",
      "code":"403",
      "matcher":"attack_sql_0"
    },{
      "enable":true,
      "action":"block",
      "code":"403",
      "matcher":"attack_backup_0"
    },{
      "enable":true,
      "action":"block",
      "code":"403",
      "matcher":"attack_scan_0"
    },{
      "enable":true,
      "action":"block",
      "code":"403",
      "matcher":"attack_code_0"
    },{
      "enable":true,
      "code":"403",
      "response":"ip_response",
      "matcher":"ip_disabled",
      "custom_response":true,
      "action":"block"
    },{
      "enable":true,
      "code":"403",
      "response":"dvwa_wresponse",
      "matcher":"dvwa_wallowed",
      "custom_response":true,
      "action":"block"
    },{
      "enable":true,
      "code":"403",
      "response":"disabled_wp/usr",
      "action":"block",
      "custom_response":true,
      "matcher":"wp_uedisabled"
    },{
      "enable":true,
      "code":"403",
      "response":"verynginx_allowed",
      "matcher":"verynginx_allowed",
      "custom_response":true,
      "action":"block"
    },{
      "enable":false,
      "code":"403",
      "response":"curl_response",
      "action":"block",
      "custom_response":true,
      "matcher":"forbid_curl"
    },{
      "enable":true,
      "code":"403",
      "response":"dvwa_bansqlres",
      "matcher":"dvwa_bansql",
      "custom_response":true,
      "action":"block"
    }],
  "config_version":"0.36",
  "static_file_rule":[],
  "proxy_pass_rule":[{
      "enable":true,
      "matcher":"dvwa",
      "upstream":"dvwa",
      "proxy_host":"dvwa.sec.cuc.edu.cn"
    },{
      "enable":true,
      "matcher":"wordpress",
      "upstream":"wordpress_http",
      "proxy_host":"wp.sec.cuc.edu.cn"
    },{
      "enable":true,
      "matcher":"wordpress",
      "upstream":"wordpress_https",
      "proxy_host":"wp.sec.cuc.edu.cn"
    }],
  "summary_collect_rule":[],
  "summary_group_persistent_enable":true,
  "admin":[{
      "user":"verynginx",
      "password":"verynginx",
      "enable":true
    }],
  "dashboard_host":"",
  "response":{
    "frequency_limitres":{
      "content_type":"text/html",
      "body":"More than the maximum nuber of visits !\nYour access is restricted !"
    },
    "curl_response":{
      "content_type":"text/html",
      "body":"Prohibit access via curl !"
    },
    "dvwa_bansqlres":{
      "content_type":"text/html",
      "body":"Prohibit sql Injection !"
    },
    "disabled_wp/usr":{
      "content_type":"text/html",
      "body":"You can't try to make it"
    },
    "verynginx_allowed":{
      "content_type":"text/html",
      "body":"You are not allowed to access the verynginx configure page!"
    },
    "demo_response_html":{
      "content_type":"text/html",
      "body":"This is a html demo response"
    },
    "ip_response":{
      "content_type":"text/html",
      "body":"Can't be accesed by ip !\nPlease provide domain name."
    },
    "demo_response_json":{
      "content_type":"application/json",
      "body":"{\"msg\":\"soms text\",\"status\":\"success\"}"
    },
    "dvwa_wresponse":{
      "content_type":"text/html",
      "body":"You are not allowed to access !"
    }
  },
  "scheme_lock_enable":false,
  "uri_rewrite_rule":[{
      "to_uri":"/verynginx/$1",
      "matcher":"demo_verynginx_short_uri",
      "replace_re":"^/vn/(.*)",
      "enable":true
    }],
  "cookie_prefix":"verynginx",
  "filter_enable":true,
  "browser_verify_enable":true,
  "scheme_lock_rule":[{
      "enable":false,
      "matcher":"verynginx",
      "scheme":"https"
    }],
  "redirect_enable":true,
  "backend_upstream":{
    "dvwa":{
      "node":{
        "dvwa":{
          "host":"192.168.56.103",
          "weight":"1",
          "scheme":"http",
          "port":"80"
        }
      },
      "method":"random"
    },
    "wordpress_https":{
      "node":{
        "wordpress_https":{
          "host":"192.168.56.101",
          "weight":"1",
          "scheme":"https",
          "port":"443"
        }
      },
      "method":"random"
    },
    "wordpress_http":{
      "node":{
        "wordpress_http":{
          "host":"192.168.56.101",
          "weight":"1",
          "scheme":"http",
          "port":"80"
        }
      },
      "method":"random"
    }
  },
  "frequency_limit_enable":true,
  "matcher":{
    "dvwa_wallowed":{
      "Host":{
        "value":"dvwa.sec.cuc.edu.cn",
        "operator":"≈"
      },
      "IP":{
        "value":"192.168.56.102",
        "operator":"!="
      }
    },
    "demo_verynginx_short_uri":{
      "URI":{
        "operator":"≈",
        "value":"^/vn"
      }
    },
    "forbid_curl":{
      "UserAgent":{
        "value":"curl",
        "operator":"≈"
      }
    },
    "ip_disabled":{
      "Host":{
        "value":"192.168.56.104",
        "operator":"≈"
      }
    },
    "demo_other_verynginx_uri":{
      "URI":{
        "operator":"=",
        "value":"/redirect_to_verynginx"
      }
    },
    "verynginx_allowed":{
      "Host":{
        "value":"192.168.56.104",
        "operator":"≈"
      },
      "IP":{
        "value":"192.168.56.104",
        "operator":"!="
      },
      "URI":{
        "value":"/verynginx/index.html",
        "operator":"≈"
      }
    },
    "wp_uedisabled":{
      "URI":{
        "value":"/wp-json/wp/v2/users/",
        "operator":"≈"
      },
      "Host":{
        "value":"wp.sec.cuc.edu.cn",
        "operator":"≈"
      }
    },
    "dvwa_bansql":{
      "Host":{
        "value":"dvwa.sec.cuc.edu",
        "operator":"≈"
      },
      "Args":{
        "operator":"≈",
        "name_operator":"*",
        "value":"(select|or|and|union|order)"
      }
    },
    "attack_scan_0":{
      "UserAgent":{
        "operator":"≈",
        "value":"(nmap|w3af|netsparker|nikto|fimap|wget)"
      }
    },
    "all_request":{
    },
    "attack_backup_0":{
      "URI":{
        "operator":"≈",
        "value":"\\.(htaccess|bash_history|ssh|sql)$"
      }
    },
    "verynginx":{
      "URI":{
        "operator":"≈",
        "value":"^/verynginx/"
      }
    },
    "localhost":{
      "IP":{
        "operator":"=",
        "value":"127.0.0.1"
      }
    },
    "attack_code_0":{
      "URI":{
        "operator":"≈",
        "value":"\\.(git|svn|\\.)"
      }
    },
    "dvwa":{
      "Host":{
        "value":"dvwa.sec.cuc.edu.cn",
        "operator":"≈"
      }
    },
    "wordpress":{
      "Host":{
        "value":"wp.sec.cuc.edu.cn",
        "operator":"≈"
      }
    },
    "attack_sql_0":{
      "Args":{
        "name_operator":"*",
        "operator":"≈",
        "value":"select.*from"
      }
    }
  },
  "static_file_enable":true,
  "summary_temporary_period":60,
  "summary_group_temporary_enable":true,
  "summary_with_host":false,
  "frequency_limit_rule":[{
      "enable":true,
      "code":"429",
      "response":"frequency_limitres",
      "matcher":"dvwa",
      "count":"49",
      "time":"1",
      "custom_response":true,
      "separate":["ip"]
    },{
      "enable":true,
      "code":"429",
      "response":"frequency_limitres",
      "matcher":"wordpress",
      "count":"19",
      "time":"1",
      "custom_response":true,
      "separate":["ip"]
    }],
  "uri_rewrite_enable":true,
  "base_uri":"/verynginx",
  "summary_request_enable":true,
  "proxy_pass_enable":true,
  "readonly":false,
  "browser_verify_rule":[]
}